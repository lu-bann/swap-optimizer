<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Hash functions by Steven Pigeon (https://hbfs.wordpress.com/)"><title>hashers::pigeon - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-9bb858ba049f1f21.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="hashers" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0 (5680fa18f 2023-08-23)" data-channel="1.72.0" data-search-js="search-f6292fe389d70017.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../hashers/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../hashers/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module pigeon</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">hashers</a>::<wbr><a class="mod" href="#">pigeon</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/hashers/pigeon.rs.html#1-130">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="hash-functions-by-steven-pigeon-httpshbfswordpresscom"><a href="#hash-functions-by-steven-pigeon-httpshbfswordpresscom">Hash functions by Steven Pigeon (https://hbfs.wordpress.com/)</a></h2>
<p>From:</p>
<ul>
<li>https://hbfs.wordpress.com/2015/09/29/hash-functions-part-i/</li>
<li>https://hbfs.wordpress.com/2015/10/06/the-anatomy-of-hash-functions-hash-functions-part-ii/</li>
<li>https://hbfs.wordpress.com/2015/10/13/testing-hash-functions-hash-functions-part-iii/</li>
<li>https://hbfs.wordpress.com/2015/10/20/three-bad-functions-hash-functions-part-iv/</li>
<li>https://hbfs.wordpress.com/2015/10/27/three-somewhat-better-functions-hash-functions-part-v/</li>
<li>https://hbfs.wordpress.com/2015/11/17/and-a-good-one-hash-functions-part-vi/</li>
</ul>
<p>as well as</p>
<ul>
<li>https://hbfs.wordpress.com/2011/11/08/mild-obfuscation/</li>
</ul>
<blockquote>
<p>In the previous entries, we learned that a good hash function for
look-ups should disperse bits as much as possible as well as being
unpredictable, that is, behave more or less like a pseudo-random
number generator. We had a few failed attempts, a few promising ones,
and now, a good one.</p>
<p>One of the weak operations in the previous hash functions is the
combination operation, which is the addition. We remarked that it
isn’t very good because it is unlikely to provoke a global change in
the hash value. Indeed, if you add an 8-bit quantity, then you’re
reasonably certain that the value changes for the first 8 bits, but
after that, changes are operated only through the carry ripple, which
has only probability \frac{1}{2}^i of being propagated to the ith bit.
That is, it is very unlikely to ripple to the end of the word.</p>
<p>So we need an operation (as simple as possible) to make sure that the
new bits are spread across, and affect, the hash value. Therefore,
we must scatter input bits. But how? Well, we could design some
bit-wise function that takes 8 bits and spread them, but that function
would be fixed, and independent of the input bits (if we consider a
permutation-type function). So we need a splatter that depends on
the input, but covers more or less all bits. Well, we can do that by
(integer) multiplying the next input byte by a large random-looking
number. A random-looking prime number, in fact. Why prime? It will not
introduce new common factors in the subsequent additions other than
those in the input.</p>
<p>Let’s pick one:</p>
<p>173773926194192273.</p>
<p>This number is 58 bits long. If you multiply an 8-bit value by a 56-bits
value, you’d get, most of the times, a 64-bits value. This time, it
is a bit bigger to compensate the fact the the 8-bit input doesn’t
necessarily use all of its 8 bits. Plus it’s prime. Why? How?</p>
<p><img src="https://hbfs.files.wordpress.com/2015/11/random-typing.gif" alt="random-typing" /></p>
<p>(Yes. For real. That how I typed it. Not sorry.) Then let’s mix the
product. Let’s use the perfect_shuffle we’ve already used. Then
combine this value with a simple addition. The combination step being
strong enough now, we could use a simple confusion step. Let’s use
cut_deck, a function that swaps the high- and low part of the word,
without exchanging bits in each parts, for a bit more confusion.</p>
</blockquote>
<p>Unfortunately, although this <em>looks</em> like a good hash function, it is
very slow, likely because it processes the input one byte at a time. If
it were modified to correctly handle a larger block, it might actually
be competitive.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Bricolage.html" title="struct hashers::pigeon::Bricolage">Bricolage</a></div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.bricolage.html" title="fn hashers::pigeon::bricolage">bricolage</a></div><div class="desc docblock-short">Provide access to Bricolage in a single call.</div></li></ul></section></div></main></body></html>